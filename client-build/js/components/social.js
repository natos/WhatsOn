define(["config/app","config/user","modules/app","models/user"],function(a,b,c,d){function e(a){if(typeof a=="undefined")return;a[r]&&f(a)}function f(a){var b=a[r]&&a[r][n];b?g(b):h()}function g(a){console.log("found a favorite"),$(".favorite","#content").attr("disable","disable").addClass("disable").data("favorite-id",a.id),$(".favorite i","#content").attr("class","icon-star")}function h(){console.log("didn't found a favorite"),$(".favorite","#content").removeAttr("disable").removeClass("disable").removeAttr("data-favorite-id"),$(".favorite i","#content").attr("class","icon-star-empty")}function i(a){if(!n){console.log("Social component","No URL defined, can't work like that!");return}var d=a.target,e=$(d),f,i,j;while(d.tagName!=="BUTTON"){if(d===this)return;d=d.parentNode}e=$(d),f=e.hasClass("disable"),action=e.pluck("className")[0];switch(action){case"like":c.emit(b.ADD_LIKE,n);break;case"like disable":c.emit(b.REMOVE_LIKE,n);break;case"favorite":c.emit(b.ADD_FAVORITE,o,n),g(id);break;case"favorite disable":i=e.data("favorite-id"),c.emit(b.REMOVE_FAVORITE,i),h();break;case"share":c.emit(b.SHARE,{method:"feed",link:n})}return}function j(a){c.on(b.MODEL_CHANGED,e),id=a.parts[0],n="http://upcsocial.herokuapp.com"+a.hash.split("?")[0],o=/programme/.test(a.url)?"tv_show":"tv_channel",r=/programme/.test(a.url)?p:q}function k(a){$("#social")[0]||u.find("header").first().append(t.html()),v=$("#social"),u.on("click",i),e(d)}function l(){v.remove(),u.off("click",i),c.off(b.MODEL_CHANGED,e)}var m="social",n,o,p="favorite-programmes",q="favorite-channels",r,s="#"+m+"-template",t=$(s),u=$("#content"),v;return{name:m,initialize:j,finalize:l,render:k}})