define(["config/user","models/user"],function(a,b){function c(){return upc.on(a.MODEL_CHANGED,d),a.$userControl.on("click","a",g),a.$loginButton.on("click",f),this}function d(a){a["facebook-status"]&&e(a["facebook-status"])}function e(b){switch(b.status){case a.CONNECTED:a.$loginButton.html('<img class="picture" src="https://graph.facebook.com/'+b.authResponse.userID+'/picture" />');break;case a.NOT_AUTHORIZED:case a.UNKNOWN:a.$loginButton.html('<i class="icon-user"></i><b class="label">Login</b>')}h=b.status}function f(b){b.preventDefault(),b.stopPropagation();switch(h){case a.CONNECTED:i.toggle();break;case a.NOT_AUTHORIZED:case a.UNKNOWN:upc.emit(a.LOG_IN)}}function g(b){switch(this.className){case"settings":console.log("settings");break;case"logout":b.preventDefault(),b.stopPropagation(),upc.emit(a.LOG_OUT)}}var h=a.UNKNOWN,i={toggle:function(){return a.$userControl.hasClass("active")?this.hide():this.show(),this},show:function(){return a.$body.one("click",function(a){i.hide()}),a.$userControl.addClass("active"),this},hide:function(){return a.$userControl.removeClass("active"),this}};return{initialize:c}})