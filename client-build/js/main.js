(function(a){function b(){this._events={},this._maxListeners=10}function c(a,b,c,d,e){this.type=a,this.listener=b,this.scope=c,this.once=d,this.instance=e}c.prototype.fire=function(a){this.listener.apply(this.scope||this.instance,a);if(this.once)return this.instance.removeListener(this.type,this.listener,this.scope),!1},b.prototype.eachListener=function(a,b){var c=null,d=null,e=null;if(this._events.hasOwnProperty(a)){d=this._events[a];for(c=0;c<d.length;c+=1){e=b.call(this,d[c],c);if(e===!1)c-=1;else if(e===!0)break}}return this},b.prototype.addListener=function(a,b,d,e){return this._events.hasOwnProperty(a)||(this._events[a]=[]),this._events[a].push(new c(a,b,d,e,this)),this.emit("newListener",a,b,d,e),this._maxListeners&&!this._events[a].warned&&this._events[a].length>this._maxListeners&&(typeof console!="undefined"&&console.warn("Possible EventEmitter memory leak detected. "+this._events[a].length+" listeners added. Use emitter.setMaxListeners() to increase limit."),this._events[a].warned=!0),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(a,b,c){return this.addListener(a,b,c,!0)},b.prototype.removeListener=function(a,b,c){return this.eachListener(a,function(d,e){d.listener===b&&(!c||d.scope===c)&&this._events[a].splice(e,1)}),this._events[a]&&this._events[a].length===0&&delete this._events[a],this},b.prototype.off=b.prototype.removeListener,b.prototype.removeAllListeners=function(a){return a&&this._events.hasOwnProperty(a)?delete this._events[a]:a||(this._events={}),this},b.prototype.listeners=function(a){if(this._events.hasOwnProperty(a)){var b=[];return this.eachListener(a,function(a){b.push(a.listener)}),b}return[]},b.prototype.emit=function(a){var b=[],c=null;for(c=1;c<arguments.length;c+=1)b.push(arguments[c]);return this.eachListener(a,function(a){return a.fire(b)}),this},b.prototype.setMaxListeners=function(a){return this._maxListeners=a,this},typeof define=="function"&&define.amd?define("lib/event/event",[],function(){return b}):a.EventEmitter=b})(this),define("config/channel",[],function(){return{DEFAULT_GROUP:"986",DATA:"data",BY_ID:"byId",GROUPS:"groups",SELECTED_GROUP:"selected_group",MODEL_CHANGED:"channel:model_changed"}}),define("config/grid",[],function(){var a=function(a){a=a||new Date;var b=new Date(a.valueOf()-216e5);return b.setMinutes(0),b.setSeconds(0),b},b=a();return{HOUR_WIDTH:200,ROW_HEIGHT:60,MILLISECONDS_IN_HOUR:36e5,TIMEBAR_HEIGHT:25,CHANNEL_BAR_WIDTH:55,VIEWPORT_WIDTH_HOURS:0,MAX_DOM_ELEMENTS:500,EXTRA_ABOVE_AND_BELOW:2,EXECUTION_DELAY:250,POSITION:"position",SELECTED_CHANNELS:"selectedChannels",SELECTED_TIME:"selectedTime",CHANNEL_SLICE_CACHE:"channelSliceCache",zeroTime:b,setZeroTime:a,EVENTS_RECEIVED:"grid:eventsReceived",MODEL_CHANGED:"grid:model_changed",GRID_FETCH_EVENTS:"grid:fetch_events",GRID_MOVED:"grid:moved",GRID_RENDERED:"grid:rendered",GRID_EVENTS_RECIEVED:"grid:events_received"}}),define("config/user",[],function(){return{APP_ID:290742221014129,SCOPE:"email, user_interests, user_likes, user_location, friends_likes, publish_actions, user_activities, user_events, friends_events, friends_online_presence, read_friendlists, user_online_presence, status_update, publish_stream, share_item, create_event, rsvp_event",LOG_IN:"user:log_in",LOG_OUT:"user:log_out",LOGGED_IN:"user:logged_in",LOGGED_OUT:"user:logged_out",STATUS_CHANGED:"user:status_changed",MODEL_CHANGED:"user:model_changed",FETCH_LIKES:"user:fetch_likes",FETCH_FAVORITES:"user:fetch_favorites",FETCH_RECORDINGS:"user:fetch_recordings",SHARE:"user:share",ADD_FAVORITE:"user:add_favorite",REMOVE_FAVORITE:"user:remove_favorite",NOT_AUTHORIZED:"not_authorized",CONNECTED:"connected",UNKNOWN:"unknown",FAVORITE_PROGRAMMES:"favorite_programmes",FAVORITE_CHANNELS:"favorite_channels",$window:$(window),$body:$(document.body),$loginButton:$(".login"),$userControl:$(".user-control")}}),function(){var a=0,b=["ms","moz","webkit","o"];for(var c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),define("/js/utils/requestAnimationFrame.js",function(){}),define("config/app",[],function(){return{NAMESPACE:"upsocial",ROOT_URL:"http://upcsocial.herokuapp.com/",NAVIGATE:"app:navigate",ACTION:"app:action",CONTROLLER_INITIALIZING:"app:controller_initializing",CONTROLLER_INITIALIZED:"app:controller_initialized",CONTROLLER_FINALIZING:"app:controller_finalizing",CONTROLLER_FINALIZED:"app:controller_finalized",VIEW_INITIALIZING:"app:view_initializing",VIEW_INITIALIZED:"app:view_initialized",VIEW_FINALIZING:"app:view_finalizing",VIEW_FINALIZED:"app:view_finalized",VIEW_RENDERING:"app:view_rendering",VIEW_RENDERED:"app:view_rendered",_doc:document,_win:window,_body:document.body,_main:document.getElementById("main"),_content:document.getElementById("content"),_transition:document.getElementById("transition")}}),define("utils/dom",[],function(){function a(a){return e[a].cloneNode(!1)}function b(a){var b={},c,d,e,f;if(a&&a.nodeType==1){c=a.attributes;if(c&&c.length){f=c.length;while(f--)d=c.item(f),e=d.nodeName,e.slice(0,5)==="data-"&&(b[e.slice(5)]=d.value)}}return b}var c="domutils",d=document,e={a:d.createElement("a"),i:d.createElement("i"),b:d.createElement("b"),li:d.createElement("li"),div:d.createElement("div"),img:d.createElement("img"),span:d.createElement("span"),style:d.createElement("style"),button:d.createElement("button"),fragment:d.createDocumentFragment()};return{name:c,create:a,getDataset:b}}),window.JSON||(window.JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)d=rep[c],typeof d=="string"&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var JSON=window.JSON,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(a,b){var c=a.History=a.History||{};if(typeof c.Adapter!="undefined")throw new Error("History.js Adapter has already been loaded...");c.Adapter={handlers:{},_uid:1,uid:function(a){return a._uid||(a._uid=c.Adapter._uid++)},bind:function(a,b,d){var e=c.Adapter.uid(a);c.Adapter.handlers[e]=c.Adapter.handlers[e]||{},c.Adapter.handlers[e][b]=c.Adapter.handlers[e][b]||[],c.Adapter.handlers[e][b].push(d),a["on"+b]=function(a,b){return function(d){c.Adapter.trigger(a,b,d)}}(a,b)},trigger:function(a,b,d){d=d||{};var e=c.Adapter.uid(a),f,g;c.Adapter.handlers[e]=c.Adapter.handlers[e]||{},c.Adapter.handlers[e][b]=c.Adapter.handlers[e][b]||[];for(f=0,g=c.Adapter.handlers[e][b].length;f<g;++f)c.Adapter.handlers[e][b][f].apply(this,[d])},extractEventData:function(a,c){var d=c&&c[a]||b;return d},onDomLoad:function(b){var c=a.setTimeout(function(){b()},2e3);a.onload=function(){clearTimeout(c),b()}}},typeof c.init!="undefined"&&c.init()}(window),function(a,b){var c=a.document,d=a.setTimeout||d,e=a.clearTimeout||e,f=a.setInterval||f,g=a.History=a.History||{};if(typeof g.initHtml4!="undefined")throw new Error("History.js HTML4 Support has already been loaded...");g.initHtml4=function(){if(typeof g.initHtml4.initialized!="undefined")return!1;g.initHtml4.initialized=!0,g.enabled=!0,g.savedHashes=[],g.isLastHash=function(a){var b=g.getHashByIndex(),c;return c=a===b,c},g.saveHash=function(a){return g.isLastHash(a)?!1:(g.savedHashes.push(a),!0)},g.getHashByIndex=function(a){var b=null;return typeof a=="undefined"?b=g.savedHashes[g.savedHashes.length-1]:a<0?b=g.savedHashes[g.savedHashes.length+a]:b=g.savedHashes[a],b},g.discardedHashes={},g.discardedStates={},g.discardState=function(a,b,c){var d=g.getHashByState(a),e;return e={discardedState:a,backState:c,forwardState:b},g.discardedStates[d]=e,!0},g.discardHash=function(a,b,c){var d={discardedHash:a,backState:c,forwardState:b};return g.discardedHashes[a]=d,!0},g.discardedState=function(a){var b=g.getHashByState(a),c;return c=g.discardedStates[b]||!1,c},g.discardedHash=function(a){var b=g.discardedHashes[a]||!1;return b},g.recycleState=function(a){var b=g.getHashByState(a);return g.discardedState(a)&&delete g.discardedStates[b],!0},g.emulated.hashChange&&(g.hashChangeInit=function(){g.checkerFunction=null;var b="",d,e,h,i;return g.isInternetExplorer()?(d="historyjs-iframe",e=c.createElement("iframe"),e.setAttribute("id",d),e.style.display="none",c.body.appendChild(e),e.contentWindow.document.open(),e.contentWindow.document.close(),h="",i=!1,g.checkerFunction=function(){if(i)return!1;i=!0;var c=g.getHash()||"",d=g.unescapeHash(e.contentWindow.document.location.hash)||"";return c!==b?(b=c,d!==c&&(h=d=c,e.contentWindow.document.open(),e.contentWindow.document.close(),e.contentWindow.document.location.hash=g.escapeHash(c)),g.Adapter.trigger(a,"hashchange")):d!==h&&(h=d,g.setHash(d,!1)),i=!1,!0}):g.checkerFunction=function(){var c=g.getHash();return c!==b&&(b=c,g.Adapter.trigger(a,"hashchange")),!0},g.intervalList.push(f(g.checkerFunction,g.options.hashChangeInterval)),!0},g.Adapter.onDomLoad(g.hashChangeInit)),g.emulated.pushState&&(g.onHashChange=function(b){var d=b&&b.newURL||c.location.href,e=g.getHashByUrl(d),f=null,h=null,i=null,j;return g.isLastHash(e)?(g.busy(!1),!1):(g.doubleCheckComplete(),g.saveHash(e),e&&g.isTraditionalAnchor(e)?(g.Adapter.trigger(a,"anchorchange"),g.busy(!1),!1):(f=g.extractState(g.getFullUrl(e||c.location.href,!1),!0),g.isLastSavedState(f)?(g.busy(!1),!1):(h=g.getHashByState(f),j=g.discardedState(f),j?(g.getHashByIndex(-2)===g.getHashByState(j.forwardState)?g.back(!1):g.forward(!1),!1):(g.pushState(f.data,f.title,f.url,!1),!0))))},g.Adapter.bind(a,"hashchange",g.onHashChange),g.pushState=function(b,d,e,f){if(g.getHashByUrl(e))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(f!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.pushState,args:arguments,queue:f}),!1;g.busy(!0);var h=g.createStateObject(b,d,e),i=g.getHashByState(h),j=g.getState(!1),k=g.getHashByState(j),l=g.getHash();return g.storeState(h),g.expectedStateId=h.id,g.recycleState(h),g.setTitle(h),i===k?(g.busy(!1),!1):i!==l&&i!==g.getShortUrl(c.location.href)?(g.setHash(i,!1),!1):(g.saveState(h),g.Adapter.trigger(a,"statechange"),g.busy(!1),!0)},g.replaceState=function(a,b,c,d){if(g.getHashByUrl(c))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(d!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.replaceState,args:arguments,queue:d}),!1;g.busy(!0);var e=g.createStateObject(a,b,c),f=g.getState(!1),h=g.getStateByIndex(-2);return g.discardState(f,e,h),g.pushState(e.data,e.title,e.url,!1),!0}),g.emulated.pushState&&g.getHash()&&!g.emulated.hashChange&&g.Adapter.onDomLoad(function(){g.Adapter.trigger(a,"hashchange")})},typeof g.init!="undefined"&&g.init()}(window),function(a,b){var c=a.console||b,d=a.document,e=a.navigator,f=a.sessionStorage||!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode;if(typeof m.init!="undefined")throw new Error("History.js Core has already been loaded...");m.init=function(){return typeof m.Adapter=="undefined"?!1:(typeof m.initCore!="undefined"&&m.initCore(),typeof m.initHtml4!="undefined"&&m.initHtml4(),!0)},m.initCore=function(){if(typeof m.initCore.initialized!="undefined")return!1;m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;if(typeof b!="undefined"&&b!==null){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){(m.options.debug||!1)&&m.log.apply(m,arguments)},m.log=function(){var a=typeof c!="undefined"&&typeof c.log!="undefined"&&typeof c.log.apply!="undefined",b=d.getElementById("log"),e,f,g,h,i;a?(h=Array.prototype.slice.call(arguments),e=h.shift(),typeof c.debug!="undefined"?c.debug.apply(c,[e,h]):c.log.apply(c,[e,h])):e="\n"+arguments[0]+"\n";for(f=1,g=arguments.length;f<g;++f){i=arguments[f];if(typeof i=="object"&&typeof k!="undefined")try{i=k.stringify(i)}catch(j){}e+="\n"+i+"\n"}return b?(b.value+=e+"\n-----\n",b.scrollTop=b.scrollHeight-b.clientHeight):a||l(e),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached=typeof m.getInternetExplorerMajorVersion.cached!="undefined"?m.getInternetExplorerMajorVersion.cached:function(){var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");while((b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c[0]);return a>4?a:!1}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached=typeof m.isInternetExplorer.cached!="undefined"?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());return a},m.emulated={pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent)),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)return!1;return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);if(d.location.port||!1)a+=":"+d.location.port;return a+="/",a},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return a.length===1&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var a=m.getState(!1,!1),b=(a||{}).url||d.location.href,c;return c=b.replace(/\/+$/,"").replace(/[^\/]+$/,function(a,b,c){return/\./.test(a)?a:a+"/"}),c},m.getBasePageUrl=function(){var a=d.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a,b,c){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b=typeof b=="undefined"?!0:b,/[a-z]+\:\/\//.test(a)||(d==="/"?c=m.getRootUrl()+a.replace(/^\/+/,""):d==="#"?c=m.getPageUrl().replace(/#.*/,"")+a:d==="?"?c=m.getPageUrl().replace(/[\?#].*/,"")+a:b?c=m.getBaseUrl()+a.replace(/^(\.\/)+/,""):c=m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,""),b},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}},m.getState=function(a,b){typeof a=="undefined"&&(a=!0),typeof b=="undefined"&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var b=m.extractId(a.url),c;if(!b){c=m.getStateString(a);if(typeof m.stateToId[c]!="undefined")b=m.stateToId[c];else if(typeof m.store.stateToId[c]!="undefined")b=m.store.stateToId[c];else{for(;;){b=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof m.idToState[b]=="undefined"&&typeof m.store.idToState[b]=="undefined")break}m.stateToId[c]=b,m.idToState[b]=a}}return b},m.normalizeState=function(a){var b,c;if(!a||typeof a!="object")a={};if(typeof a.normalized!="undefined")return a;if(!a.data||typeof a.data!="object")a.data={};b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(m.unescapeString(a.url||d.location.href)),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data);if(b.title||c)b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id;return b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d),d},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c),d},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id,c},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),c=b.hash,c},m.extractId=function(a){var b,c,d;return c=/(.*)\&_suid=([0-9]+)$/.exec(a),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var c=null,d,e;return b=b||!1,d=m.extractId(a),d&&(c=m.getStateById(d)),c||(e=m.getFullUrl(a),d=m.getIdByUrl(e)||!1,d&&(c=m.getStateById(d)),!c&&b&&!m.isTraditionalAnchor(a)&&(c=m.createStateObject(null,null,e))),c},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b},m.hasUrlDuplicate=function(a){var b=!1,c;return c=m.extractState(a.url),b=c&&c.id!==a.id,b},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var b=!1,c,d,e;return m.savedStates.length&&(c=a.id,d=m.getLastSavedState(),e=d.id,b=c===e),b},m.saveState=function(a){return m.isLastSavedState(a)?!1:(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return typeof a=="undefined"?b=m.savedStates[m.savedStates.length-1]:a<0?b=m.savedStates[m.savedStates.length+a]:b=m.savedStates[a],b},m.getHash=function(){var a=m.unescapeHash(d.location.hash);return a},m.unescapeString=function(b){var c=b,d;for(;;){d=a.unescape(c);if(d===c)break;c=d}return c},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=m.unescapeString(b),b},m.normalizeHash=function(a){var b=a.replace(/[^#]*#/,"").replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e,f;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(c=m.escapeHash(a),m.busy(!0),e=m.extractState(a,!0),e&&!m.emulated.pushState?m.pushState(e.data,e.title,e.url,!1):d.location.hash!==c&&(m.bugs.setHash?(f=m.getPageUrl(),m.pushState(null,null,f+"#"+c,!1)):d.location.hash=c),m)},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.escape(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b),b},m.setTitle=function(a){var b=a.title,c;b||(c=m.getStateByIndex(0),c&&c.url===a.url&&(b=c.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=b.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return d.title=b,m},m.queues=[],m.busy=function(a){typeof a!="undefined"?m.busy.flag=a:typeof m.busy.flag=="undefined"&&(m.busy.flag=!1);if(!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(m.busy.flag)return;for(a=m.queues.length-1;a>=0;--a){c=m.queues[a];if(c.length===0)continue;d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay)}};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m},m.queue=function(a,b){return typeof a=="function"&&(a={callback:a}),typeof b!="undefined"&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b=m.extractState(d.location.href),c;if(!m.isLastSavedState(b))c=b;else return;return c||(c=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;c<=a;++c)m.forward(b);else{if(!(a<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m};if(m.emulated.pushState){var o=function(){};m.pushState=m.pushState||o,m.replaceState=m.replaceState||o}else m.onPopState=function(b,c){var e=!1,f=!1,g,h;return m.doubleCheckComplete(),g=m.getHash(),g?(h=m.extractState(g||d.location.href,!0),h?m.replaceState(h.data,h.title,h.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(e=m.Adapter.extractEventData("state",b,c)||!1,e?f=m.getStateById(e):m.expectedStateId?f=m.getStateById(m.expectedStateId):f=m.extractState(d.location.href),f||(f=m.createStateObject(null,null,d.location.href)),m.expectedStateId=!1,m.isLastSavedState(f)?(m.busy(!1),!1):(m.storeState(f),m.saveState(f),m.setTitle(f),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(p){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"beforeunload",m.clearAllIntervals),m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(d.location.href,!0))),f&&(m.onUnload=function(){var a,b;try{a=k.parse(f.getItem("History.store"))||{}}catch(c){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState){if(!m.idToState.hasOwnProperty(b))continue;a.idToState[b]=m.idToState[b]}for(b in m.urlToId){if(!m.urlToId.hasOwnProperty(b))continue;a.urlToId[b]=m.urlToId[b]}for(b in m.stateToId){if(!m.stateToId.hasOwnProperty(b))continue;a.stateToId[b]=m.stateToId[b]}m.store=a,m.normalizeStore(),f.setItem("History.store",k.stringify(a))},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload));if(!m.emulated.pushState){m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval));if(e.vendor==="Apple Computer, Inc."||(e.appCodeName||"")==="Mozilla")m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})}},m.init()}(window),define("/js/lib/history/1.7.1-r2/bundled/html4+html5/native.history.js",function(){}),define("lib/flaco/model",[],function(){function a(a){function c(a){return["set","get"].indexOf(a)>=0}function d(b){c(b)||(e[b]=a[b])}var e={},f=a.event,g;for(g in a)d(g);return e.set=function(a,c){e[a]=c;var d={};return d[a]=c,f&&require([b],function(a){a.emit(f,d)}),d},e}var b="modules/app";return a}),define("models/channel",["config/channel","lib/flaco/model"],function(a,b){var c="channel";return new b({name:c,event:a.MODEL_CHANGED})}),define("models/grid",["config/grid","lib/flaco/model"],function(a,b){var c="grid";return new b({name:c,event:a.MODEL_CHANGED})}),define("models/user",["config/user","lib/flaco/model"],function(a,b){var c="user";return new b({name:c,event:a.MODEL_CHANGED})}),define("components/user",["config/user","models/user"],function(a,b){function c(){return upc.on(a.MODEL_CHANGED,d),a.$userControl.on("click","a",g),a.$loginButton.on("click",f),this}function d(a){a["facebook-status"]&&e(a["facebook-status"])}function e(b){switch(b.status){case a.CONNECTED:a.$loginButton.html('<img class="picture" src="https://graph.facebook.com/'+b.authResponse.userID+'/picture" />');break;case a.NOT_AUTHORIZED:case a.UNKNOWN:a.$loginButton.html('<i class="icon-user"></i><b class="label">Login</b>')}h=b.status}function f(b){b.preventDefault(),b.stopPropagation();switch(h){case a.CONNECTED:i.toggle();break;case a.NOT_AUTHORIZED:case a.UNKNOWN:upc.emit(a.LOG_IN)}}function g(b){switch(this.className){case"settings":console.log("settings");break;case"logout":b.preventDefault(),b.stopPropagation(),upc.emit(a.LOG_OUT)}}var h=a.UNKNOWN,i={toggle:function(){return a.$userControl.hasClass("active")?this.hide():this.show(),this},show:function(){return a.$body.one("click",function(a){i.hide()}),a.$userControl.addClass("active"),this},hide:function(){return a.$userControl.removeClass("active"),this}};return{initialize:c}}),define("utils/channel",["config/channel","models/channel","modules/app"],function(a,b,c){function d(c){var d={},f={},g,h,i,j,k,l,m=c.length;d["000"]=[],d["001"]=[];for(j=0;j<m;j++){h=c[j],f[h.id]=h,f[h.id].logo=e(h),d["000"].push(h),delete h._type,delete h.apiChannelGroupId,delete h.broadcastFormat,delete h.logoIMG,delete h.position,k=h.domains.length;while(k--){i=h.domains[k],l=i.groups.length;while(l--)g=i.groups[l],d[g]||(d[g]=[]),d[g].push(h)}}return b.set(a.BY_ID,f),b.set(a.GROUPS,d),b.set(a.SELECTED_GROUP,a.DEFAULT_GROUP),c}function e(a){if(!a.links)return;var b=!1,c=a.links.length;while(c--)a.links[c].rel==="logo"&&(foundit=a.links[c]);return foundit}function f(a){$.getJSON("/channels.json",function(b,e,f){a&&a.apply(c,b),d(b)})}var g="channelutils";return{name:g,fetchAnd:f}}),define("modules/app",["lib/event/event","utils/channel","models/channel","models/grid","models/user"],function(a,b,c,d,e){function f(){return b.fetchAnd(function(a){window.channels=l.channels=a,require(["modules/user","modules/canvas","modules/router"],function(){while(module=k.apply(arguments))l.modules[module.name]=module.initialize()})}),l}function g(a){var b=document.createElement("link");b.type="text/css",b.rel="stylesheet",b.href=a,document.getElementsByTagName("head")[0].appendChild(b)}function h(a){var b=l.channels,c=[],d,e,f,g,h;for(d=0,f=b.length;d<f;d++){g=b[d];if(g&&g.domains){e=g.domains.length;while(e){e-=1;if(g.domains[e].id==="Filter"){g.domains[e].groups.indexOf(a)>=0&&c.push(g);break}}}}return c}function i(){var a="(Android 1.5)|(Android 1.6)|(Android 2.1)|(Android 2.2)";NaN;var b=new RegExp(a);return!b.test(navigator.userAgent)}function j(){var a="(Android 1.5)|(Android 1.6)|(Android 2.1)|(Android 2.2)|(Android 2.3)",b=new RegExp(a);return!b.test(navigator.userAgent)}var k=Array.prototype.shift,l=new a;return l.modules={},l.name="UPC Social",l.initialize=f,l.loadCss=g,l.getChannelsByFilterGroup=h,l.models={channel:c,grid:d,user:e},l.allowGrid=i,l.can3DTransformPositionFixed=j,l}),require.config({}),console&&console.log&&console.log("mustard = "+window.mustard),window.mustard&&require(["modules/app","/js/utils/requestAnimationFrame.js"],function(a){if(!window.console||!window.console.log)window.console={assert:function(){},log:function(){},warn:function(){},error:function(){},debug:function(){},dir:function(){},info:function(){}};window.upc=a.initialize(),window.app=a}),define("main",function(){}),define("modules/user",["config/user","config/channel","modules/app","models/user","models/channel","components/user"],function(a,b,c,d,e,f){function g(b){d.set(FACEBOOK_STATUS,b);switch(b.status){case a.CONNECTED:h();break;case a.NOT_AUTHORIZED:case a.UNKNOWN:i()}}function h(){n(),o(),c.emit(a.LOGGED_IN)}function i(){c.emit(a.LOGGED_OUT),d.set(FACEBOOK_STATUS,!1),d.set(FAVORITES,!1),d.set(FAVORITE_PROGRAMMES,!1),d.set(FAVORITE_CHANNELS,!1),e[b.GROUPS]["001"].length=0}function j(){function b(a){if(a&&a.error){console.log("Error on UserModule","Can't login",a);return}typeof d=="function"&&d(c)}var c=w.call(arguments,0),d=c.shift();FB.login(b,{scope:a.SCOPE})}function k(){FB.logout(function(a){})}function l(){return d[FACEBOOK_STATUS]?!0:!1}function m(a){function b(a){return g=a,{saveTo:c}}function c(a){return h=a,{process:d}}function d(a){i=a,f&&g&&h&&FB.api(g,e)}function e(a){if(!a){console.log("Warning!",f,g,h.name,": Open graph has sent an empty response",a);return}if(i){i({label:f,call:g,model:h,callback:i,response:a});return}h.set(f,a)}var f=a,g,h,i;return{from:b}}function n(){m(LIKES).from(LIKES_CALL).saveTo(d).process()}function o(){m(FAVORITES).from(FAVORITES_CALL).saveTo(d).process(function(a){a.model.set(a.label,a.response);var c="tv_show",d="tv_channel",f={},g={},h;a.response.data.forEach(function(a){c in a.data&&a.data[c].url&&(f[a.data[c].url]=a),d in a.data&&a.data[d].url&&(g[a.data[d].url]=a,h=a.data[d].url.split("http://upcsocial.herokuapp.com/channel/")[1],e[b.GROUPS]["001"].push(e[b.BY_ID][h]))}),a.model.set(FAVORITE_PROGRAMMES,f),a.model.set(FAVORITE_CHANNELS,g)})}function p(){m(RECORDINGS).from(RECORDINGS_CALL).saveTo(d).process()}function q(a){if(!l()){j(function(){q(a)});return}FB.ui(a,function(a){if(!a||a.error){console.log("Error occured trying to share on the wall",a);return}console.log("Shared",a)})}function r(a,b){if(!l()){j(function(){r(a,b)});return}a=a.split("upcsocial:").join("");var c={};c[a]=b,FB.api("/me/upcsocial:favorite","post",c,function(a){if(!a||a.error){console.log("Error occured trying to add a new favorite",a);return}console.log("Favorite was added",a),o()})}function s(a){if(!l()){j(function(){s(a)});return}FB.api(a,"delete",function(a){if(!a||a.error){console.log("Error occured trying to remove favorite",a);return}console.log("Favorite was deleted"),o()})}function t(){if(typeof FB=="undefined"){console.log("User: waiting for facebook SDK"),require(["http://connect.facebook.net/en_US/all.js"],function(){t(),console.log("User: facebook SDK ready!")});return}return FB.Event.subscribe(AUTH_STATUS_CHANGE,g),FB.init({appId:a.APP_ID,status:!0,cookie:!0,xfbml:!0}),this.components={user:f.initialize()},c.on(a.LOG_IN,j),c.on(a.LOG_OUT,k),c.on(a.FETCH_LIKES,n),c.on(a.FETCH_FAVORITES,o),c.on(a.FETCH_RECORDINGS,p),c.on(a.SHARE,q),c.on(a.ADD_FAVORITE,r),c.on(a.REMOVE_FAVORITE,s),this}function u(){return FB.Event.unsubscribe(AUTH_STATUS_CHANGE,g),c.off(a.LOG_IN,j),c.off(a.LOG_OUT,k),c.off(a.FETCH_LIKES,n),c.off(a.FETCH_FAVORITES,o),c.off(a.FETCH_RECORDINGS,p),c.off(a.SHARE,q),c.off(a.ADD_FAVORITE,r),c.off(a.REMOVE_FAVORITE,s),this.components.user=f.finalize(),this}var v="user",w=Array.prototype.slice;return FACEBOOK_STATUS="facebook-status",AUTH_STATUS_CHANGE="auth.statusChange",OPEN_GRAPH_PREFIX="/me/upcsocial:",LIKES_CALL="/me/likes",FAVORITES_CALL=OPEN_GRAPH_PREFIX+"favorite",RECORDINGS_CALL=OPEN_GRAPH_PREFIX+"record",LIKES="likes",FAVORITES="favorites",RECORDINGS="recordings",FAVORITE_PROGRAMMES="favorite-programmes",FAVORITE_CHANNELS="favorite-channels",{name:v,initialize:t,model:d}}),define("modules/router",["config/app","modules/app","utils/dom","/js/lib/history/1.7.1-r2/bundled/html4+html5/native.history.js"],function(a,b,c){function d(){$(".nav").append('<a href="/grid" class="grid"><i class="icon-th"></i><b class="label">TV Gids</b></a>')}function e(){var c=n.getState(),d=n.getShortUrl(c.url);d.slice(0,1)==="/"&&(d=d.slice(1)),d.slice(0,2)==="./"&&(d=d.slice(2)),c.parts=d.split(/[\/\?\&=\#]/gi),c.controller=c.parts?o.apply(c.parts):"",b.emit(a.NAVIGATE,c)}function f(a){var b=$("."+a.name);b[0]&&($(".nav a").removeClass("active"),b.addClass("active"))}function g(d){var e=anchor=d.target,f;f=c.getDataset(e);while(!f.action){if(e===this)break;e=e.parentNode,f=c.getDataset(e)}f.action&&b.emit(a.ACTION,f.action,e);while(!anchor.href){if(anchor===this)break;anchor=anchor.parentNode}anchor.href&&(d.preventDefault(),f=c.getDataset(anchor),j(f,anchor.title,anchor.href))}function h(){return n.Adapter.bind(window,m,e),b.on(a.VIEW_INITIALIZING,f),a._main.addEventListener("click",g,!1),e(),b.allowGrid()&&d(),this}function i(){return n.Adapter.unbind(window,m,e),b.off(a.VIEW_INITIALIZING,f),a._main.removeEventListener("click",g,!1),this}function j(a,b,c){return n.pushState(a,b,c),this}function k(a,b,c){return n.replaceState(a,b,c),this}var l="router",m="statechange",n=window.History,o=Array.prototype.shift;return{name:l,initialize:h,navigate:j}}),define("modules/canvas",["config/app","modules/app","modules/router"],function(a,b,c){function d(){a._transition.className="background",a._content.appendChild(a._transition)}function e(){a._transition.className="background hide",setTimeout(function(){a._transition.parentNode&&a._transition.parentNode.removeChild(a._transition)},500)}function f(a){if(!a){console.log("loadController","State object is empty, can't load a controller without information.");return}v=a;var b=y[a.controller];if(typeof b=="undefined"){console.log("loadController",a.controller," doesn't exists, go an get it, lazy loading."),h("controllers/"+a.controller);return}if(typeof b[w]!="function"){console.log("Canvas Module",b.name+" doesn't have a 'initialize' method available.");return}g(b)}function g(a){a[w](v)}function h(a){require([a],function(a){y[a.name]=a,g(a)})}function i(a){if(!a){console.log("unloadController","State object is empty, must be the first load.");return}j(y[a.controller])}function j(a){if(typeof a[x]!="function"){console.log("Canvas Module",a.name+" can't be finalized, 'finalize' method is not a function.");return}a[x]()}function k(a){if(typeof a=="undefined"){console.log("Canvas Module","State object is empty. Stop navigation.");return}if(a===v){console.log("Canvas Module",a.name+" controller already loaded.");return}if(a.controller==="grid"&&!b.allowGrid()){c.navigate({},"","/dashboard");return}i(v),f(a),o()}function l(a,b){switch(a){case"TOGGLE-MENU":m()}}function m(){/open/.test(t.className)?o():n(),console.log(u.className)}function n(){t.className="open",u.className="nav active"}function o(){t.className="",u.className="nav"}function p(){return b.on(a.NAVIGATE,k),b.on(a.NAVIGATE,d),b.on(a.VIEW_RENDERED,e),b.on(a.ACTION,l),b.can3DTransformPositionFixed()||(document.documentElement.className+=" css-no-3d-transform-position-fixed"),this}function q(){return b.off(a.NAVIGATE,k),b.off(a.NAVIGATE,d),b.off(a.VIEW_RENDERED,e),b.off(a.ACTION,manageActions),this}var r="canvas",s=Array.prototype.shift,t=a._doc.getElementById("main"),u=a._doc.getElementsByTagName("nav")[0],v=!1,w="initialize",x="finalize",y={};return{name:r,controllers:y,initialize:p,finalize:q}}),define("lib/flaco/controller",["config/app","modules/app"],function(a,b){function c(c){function e(e){function g(a){return r[a]}function m(){var a=k.call(arguments,0);return p&&b.emit(p,f,a),n&&n.apply(f,a),o&&o.apply(f,a),q&&b.emit(q,f,a),this}var n=c[e],o=l[e],p=a[d+"_"+h.present(e)],q=a[d+"_"+h.past(e)],r={};r[i]=function(){return m.apply(f,arguments)},r[j]=function(){return m.apply(f,arguments)},f[e]=g(e)?r[e]:c[e]}var f={},g,h={present:function(a){return a.replace(/^(\w+)(?:e)$/gi,"$1ing").toUpperCase()},past:function(a){return a.replace(/^(\w+)(?:e)$/gi,"$1ed").toUpperCase()}},l=c.view;for(g in c)e(g);return f}var d="CONTROLLER",e="name",f="method",g="present",h="past",i="initialize",j="finalize",k=Array.prototype.slice;return c}),define("lib/flaco/view",["config/app","modules/app"],function(a,b){function c(a){var b=e(a).replace(/\//g,"-");return b=b==="-"?"":b,a.name+b+"-template"}function d(a){return"#"+c(a)}function e(a){return a.State&&a.State.parts?"/"+a.State.parts.join("/"):""}function f(a){return $(d(a))[0]}function g(a){return $("#"+a.name+"-content")[0]}function h(a){var b="/"+a.name+e(a);$.get(b,function(b){j(a,b),i(a)})}function i(b){a._content.innerHTML=$(d(b)).text();var c={},e,f,g,h,e=$("head").find("meta");e.forEach(function(a){g=$(a).attr("property"),h=$(a).attr("content"),g&&h&&(c[g]={property:g,content:h,element:a})});var i=$("#content").find("meta");i.forEach(function(a){g=$(a).attr("property"),h=$(a).attr("content"),c[g]&&c[g].content!==h&&(c[g].element.content=h)}),b.render()}function j(a,b){var b=b||$("#content").html(),e=f(a)?$(d(a)):$(v).attr("id",c(a)).appendTo("#templates");e.text(b)}function k(a){if(g(a)){a.render();return}f(a)?i(a):(console.log("template doesn't exist, fetch template"),h(a))}function l(a){j(a)}function m(c){function d(a,b){if(!i)return;var c,d;for(c in i)i.hasOwnProperty(c)&&(d=i[c],typeof d[a]=="function"&&d[a].apply(d,b))}function e(e){function g(a){return m[a]}function i(){var a=w.call(arguments,0);return e===t&&(f.State=a[0]),k&&b.emit(k,f,a),j&&j.apply(f,a),d.call(f,e,a),l&&b.emit(l,f,a),this}var j=c[e],k=a[n+"_"+h.present(e)],l=a[n+"_"+h.past(e)],m={};m[t]=function(){return i.apply(f,arguments)},m[s]=function(){return i.apply(f,arguments)},m[u]=function(){return i.apply(f,arguments)},f[e]=g(e)?m[e]:c[e]}var f={},g,h=function(){function a(a,b,c,d){return/er$/.test(a)?b+c+"ing":b+"ing"}function b(a,b,c,d){return/er$/.test(a)?b+c+"ed":b+"ed"}var c=/^(\w+)(e|er)$/gi;return{present:function(b){return b.replace(c,a).toUpperCase()},past:function(a){return a.replace(c,b).toUpperCase()}}}(),i=c.components;for(g in c)e(g);return f}var n="VIEW",o="name",p="method",q="present",r="past",s="render",t="initialize",u="finalize",v='<script type="text/template">',w=Array.prototype.slice;return b.on(a.VIEW_INITIALIZED,k),b.on(a.VIEW_FINALIZING,l),m})